<!DOCTYPE html>

<!-- https://www.w3.org/TR/SVG/paths.html#PathData -->
<!-- https://www.w3.org/TR/SVG/text.html#TextLayoutPath -->
<html>
<head>
  <title>Garden.js</title>
  <script src="svg.js"></script>
</head>
<body>
	<div id="drawing"></div>

	<div id="root">
		I struggle with
			<div>choosing a direction for my work.</div>
			<div>deciding what to write each time I [pick up the pen / crack open my laptop]
				<div>I have too many things to say!</div>            
				<div>
					I realize that anything I have to say [has either]
					<div>has already been said (far more eloquently than I ever could)</div>
					<div>[or] lacks any real depth: my thoughts are fleeting, my ideas sometimes feel simple. I catch myself
						<div>ruminating on the 'length' of a thought: how many points do I really have to make? how far down have I thought this through? Is it worth even beginning?</div>
						<div>spiraling down through the chain of possible worlds, wondering if I'll pull a black stone that will collapse the waveform.
							<div>Because I know that once you commit a thought to the page, it dictates everything else that follows. Even if you cross it out, delete it.
								<div>It's still been there.</div>
								<div>You remember.</div>
							</div>
						</div>
					</div>
				</div>
			</div>
	</div>

<script>
	var t1 = "I started taking mental health seriously when I was diagnosed with generalized anxiety. I realized something must have been off before my diagnosis, but I chose to ignore it."
	var t2 = "I started taking mental health seriously when someone I knew was diagnosed with depression. I hadnâ€™t even really noticed anything was wrong, and that scared me."
	var draw = SVG('drawing').size(window.innerWidth, window.innerHeight);
	draw.viewbox(0, 0, 100, 100);

	function drawBranch(string, start, angle) {
		console.log('start', start)
		var text = draw.text(function(add) { add.tspan(string) })
		var length = 30;
		var end = [start[0] + length * Math.cos(angle), start[1] + length * Math.sin(angle)];
		var path = 'M ' + start[0].toString() + ' ' + start[1].toString() + ' L ' + end[0].toString() + ' ' + end[1].toString(); //+ ' M ' + end[0].toString() + ' ' + end[1].toString();
		console.log('path', path);
		// 10 100 t 50 10 T 200 100 T 300 100';
		text.path(path).font({size: 3})
		var textpath = text.textPath().attr('startOffset', '0')
		return end;
	}

	function drawForkingPaths(div, start, angle) {
		var end;

		if (div.firstChild) {
			let text = div.firstChild.data;
			console.log(text.trim());
			end = drawBranch(text, start, angle);
		} else {
			end = start;
		}
		console.log('end', end)

		// Recurse through children
		let children = div.childNodes;
		let newAngle = 0;
		for(let child of children) {
			if (child.nodeName == 'DIV') {
				drawForkingPaths(child, end, newAngle);
				newAngle += Math.PI / 2 * 1 / (children.length);
			}
		}
	}

	var root = document.getElementById('root');
	var divs = root.getElementsByTagName('div');
	drawForkingPaths(root, [0, 50], 0);

</script>


</body>
</html>